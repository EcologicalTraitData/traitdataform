<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to 'traitdataform' • traitdataform</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to 'traitdataform'">
<meta property="og:description" content="traitdataform">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">traitdataform</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/traitdataform.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ecologicaltraitdata/traitdataform/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="traitdataform_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to ‘traitdataform’</h1>
                        <h4 class="author">Florian D. Schneider</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ecologicaltraitdata/traitdataform/blob/master/vignettes/traitdataform.Rmd"><code>vignettes/traitdataform.Rmd</code></a></small>
      <div class="hidden name"><code>traitdataform.Rmd</code></div>

    </div>

    
    
<p>Assistance for handling functional trait data and transferring them into the Ecological Trait-data Standard (Schneider et al. 2018, <a href="https://terminologies.gfbio.org/terms/ets/pages/" class="uri">https://terminologies.gfbio.org/terms/ets/pages/</a> doi: <a href="http://dx.doi.org/10.5281/zenodo.1485739">10.5281/zenodo.1485739</a>).</p>
<p>There are two major use cases for the package:</p>
<ul>
<li>preparation of own trait datasets for upload into public data bases, and</li>
<li>harmonizing trait datasets from different sources by moulding them into a unified format.</li>
</ul>
<p>The toolset of the package includes</p>
<ol style="list-style-type: decimal">
<li>transforming typical trait-data formats (e.g. species-trait-matrix or measurement-table data) into a unified long-table format and mapping column names into terms provided in the Ecological Trait-data Standard (ETS) (see section <a href="#reading-data">1. Reading data</a>),</li>
<li>mapping of trait concepts onto a user-provided trait list (i.e. a thesaurus of traits) or globally accessible URIs (see section <a href="#standardize-traits">2. Standardize traits</a>) and unify units and factor levels,</li>
<li>mapping of species concepts onto globally accessible definitions via URIs (pointing to GFBio taxonomic ontology server) (see section <a href="#standardize-taxa">3. Standardize taxa</a>),</li>
<li>Merging and handling compiled trait-data, while keeping track of the metadata for each original dataset (see section <a href="#working-with-trait-datasets">4. Working with trait-datasets</a>)</li>
<li>saving trait dataset into a desired format using templates (e.g. for project-specific databases or online repositories) (see section <a href="#writing-data">5. Writing data</a>)</li>
</ol>
<p>This vignette contains step-by step instructions for transferring own data into a standardized trait-dataset for upload to public databases. See Schneider et al. 2019 Towards an Ecological Trait-data Standard <em>Methods in Ecology and Evolution</em> DOI: <a href="https://doi.org/10.1111/2041-210X.13288">10.1111/2041-210X.13288</a>) for a discussion of the rationale.</p>
<hr>
<div id="reading-data" class="section level1">
<h1 class="hasAnchor">
<a href="#reading-data" class="anchor"></a>1. Reading data</h1>
<div id="load-data-from-source" class="section level2">
<h2 class="hasAnchor">
<a href="#load-data-from-source" class="anchor"></a>load data from source</h2>
<p>The first step is to load your data into R. This can be your own data, read from file, or data published elsewhere, directly accessible via an URL.</p>
<p>R knows many ways of getting your data into an R object. In most cases you would read an object from a csv or txt file while maintaining the column headers.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">carabids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"../../data/carabid traits final.txt"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>If reading files from a file repository, you can refer to the URL directly, e.g. </p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># pulling data from van der Plas F, van Klink R, Manning P, Olff H, Fischer M (2017) Sensitivity of functional diversity metrics to sampling intensity. Methods in Ecology and Evolution 8(9): 1072-1080. https://doi.org/10.1111/2041-210x.12728</span>

<span class="va">carabids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="st">"https://datadryad.org/stash/downloads/file_stream/23901"</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Most trait data are stored in one of the following two formats:</p>
<ul>
<li>
<strong>species<span class="math inline">\(\times\)</span>trait matrix</strong> : a single account of a trait value for each species (in rows) for a couple of different traits (in columns). No replicates of species are reported. This is the most likely format for literature data, where aggregate measurements or facts for entire species have been collated into a single lookup table.</li>
<li>
<strong>observation wide table</strong> : in case of measured data, authors may report multiple raw measurements of different traits (in columns) taken from a single observation instance of a species, i.e. an individual (in rows). Repeated measures of the same trait might also be included as columns or pooled into average values. This is valuable for investigations of intra-specific variation, and also leaves space for filtering by co-factors or analyzing trait response along environmental gradients.</li>
</ul>
<p>In both cases, additional information on the species or observation may be stored in further columns (e.g. the unit in which a value is reported or the literature source for this measurement or fact, or the date and geolocation of sampling), or in a separate data sheet linked via identifiers for trait, taxon, occurrence or sampling/measurement event. As the column names and the width of the table varies with the number of traits included, merging data from different sources requires user-defined mapping and manual harmonization of these structures.</p>
<p>A more effective format is the <strong>measurement long-table</strong> <span class="citation">(Kattge et al., 2011; Wickham, 2014; Parr et al., 2016)</span>, where each row is reserved for a single measurement or fact of a specific trait. This allows repeated measurements on a single individual to be stored by linking the data from separate rows via a unique identifier for each individual (labelled <code>occurrenceID</code>). Also, multivariate trait measurements can be recorded in this format by linking multiple rows via a unique measurement identifier. Long-table datasets purport multiple advantages for data manipulation (e.g. filtering, sub-setting and aggregating data), visualization (e.g. plot measured values by factor variable or taxon) and statistical modelling (e.g. ANOVA for testing difference of trait value by sex) <span class="citation">(Wickham, 2014)</span>. Each row of the dataset can therefore be interpreted as a statement of an ‘entity x having a qualitative/quantitative feature y’ <span class="citation">(Garnier et al., 2017; Schneider et al., 2018)</span>. As long-table formats draw from a defined set of columns, merging of datasets is much easier.</p>
<p>The function <code><a href="../reference/as.traitdata.html">as.traitdata()</a></code> provided in the package assist in transferring data into the measurement long-table format. For this function to work, it needs at least to know about the columns of the original data that contain trait values (parameter <code>traits</code>), and the column which contains the taxonomic concept (parameter <code>taxa</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.traitdata.html">as.traitdata</a></span><span class="op">(</span><span class="va">carabids</span>, 
                         taxa <span class="op">=</span> <span class="st">"name_correct"</span>,
                         traits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"body_length"</span>, 
                                    <span class="st">"antenna_length"</span>, 
                                    <span class="st">"metafemur_length"</span>, 
                                    <span class="st">"eyewidth_corr"</span><span class="op">)</span>,
                         units <span class="op">=</span> <span class="st">"mm"</span>
                         <span class="op">)</span>
<span class="co">#&gt; Input is taken to be a species -- trait matrix. If this is not the case, please provide parameters!</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataset1</span><span class="op">)</span>
<span class="co">#&gt;   verbatimScientificName verbatimTraitName verbatimTraitValue verbatimTraitUnit</span>
<span class="co">#&gt; 1  Abax_parallelepipedus       body_length          15.846561                mm</span>
<span class="co">#&gt; 2   Acupalpus_meridianus       body_length           2.670000                mm</span>
<span class="co">#&gt; 3         Agonum_ericeti       body_length           5.873016                mm</span>
<span class="co">#&gt; 4     Agonum_fuliginosum       body_length           5.090000                mm</span>
<span class="co">#&gt; 5         Agonum_gracile       body_length           4.880000                mm</span>
<span class="co">#&gt; 6      Agonum_marginatum       body_length           8.250000                mm</span>
<span class="co">#&gt;   measurementID measurementDeterminedBy measurementRemarks</span>
<span class="co">#&gt; 1             1                   klink               &lt;NA&gt;</span>
<span class="co">#&gt; 2             2                WOODCOCK               &lt;NA&gt;</span>
<span class="co">#&gt; 3             3                   klink               &lt;NA&gt;</span>
<span class="co">#&gt; 4             4                  ribera               &lt;NA&gt;</span>
<span class="co">#&gt; 5             5                  ribera deduced_from_genus</span>
<span class="co">#&gt; 6             6                  ribera               &lt;NA&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This trait-dataset contains 4 traits for 120 taxa ( 480 measurements in total).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  carabids : Carabid traits by Fons van der Plas .</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     When using these data, you must acknowledge the following usage policies: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Cite this trait dataset as: </span>
<span class="co">#&gt; van der Plas F, van Klink R, Manning P, Olff H, Fischer M (2017).</span>
<span class="co">#&gt; "Sensitivity of functional diversity metrics to sampling intensity."</span>
<span class="co">#&gt; _Methods in Ecology and Evolution_. doi: 10.1111/2041-210x.12728 (URL:</span>
<span class="co">#&gt; https://doi.org/10.1111/2041-210x.12728).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Published under: http://creativecommons.org/publicdomain/zero/1.0/ </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     This dataset conforms to: [1] "Ecological Trait-data Standard (ETS) v0.10"</span></code></pre></div>
<p>Note that in the output table the columns have been renamed <a href="https://terminologies.gfbio.org/terms/ets/pages/">according to the ETS</a>. The essential columns are <code>verbatimTraitName</code>, <code>verbatimTraitValue</code> for the reported measurement or fact as well as <code>verbatimScientificName</code> for the taxon concept. The newly assigned column <code>measurementID</code> contains a running number for each individual trait measurement.<br>
The function automatically interprets data as a species<span class="math inline">\(\times\)</span>traits matrix if the taxa column contains only unique entries and no duplicates. In case of multiple assignments to the same taxon, the script assumes an observation wide-table and procures a new column <code>occurrenceID</code> which links measurements taken on the same individuals. Both <code>occurrenceID</code> and <code>measurementID</code> can be provided by the author using the parameter <code>occurrences</code> (as a column name or a vector) or <code>measurements</code> (as a column name or a vector).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#</span>
<span class="co"># heteroptera_raw</span>
<span class="co">#</span>
<span class="co"># dataset included in package traitdataform </span>
<span class="co">#</span>
<span class="co"># Data publication: M. Gossner, Martin; K. Simons, Nadja; Hoeck, Leonhard; W.</span>
<span class="co"># Weisser, Wolfgang (2016): Morphometric measures of Heteroptera sampled in</span>
<span class="co"># grasslands across three regions of Germany. figshare.</span>
<span class="co"># https://doi.org/10.6084/m9.figshare.c.3307611.v1</span>


<span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.traitdata.html">as.traitdata</a></span><span class="op">(</span><span class="va">heteroptera_raw</span>,
              traits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Body_length"</span>, <span class="st">"Body_width"</span>, <span class="st">"Body_height"</span>, <span class="st">"Thorax_length"</span>,
                         <span class="st">"Thorax_width"</span>, <span class="st">"Head_width"</span>, <span class="st">"Eye_width"</span>, <span class="st">"Antenna_Seg1"</span>,
                         <span class="st">"Antenna_Seg2"</span>, <span class="st">"Antenna_Seg3"</span>, <span class="st">"Antenna_Seg4"</span>, <span class="st">"Antenna_Seg5"</span>,
                         <span class="st">"Front.Tibia_length"</span>, <span class="st">"Mid.Tibia_length"</span>, <span class="st">"Hind.Tibia_length"</span>,
                         <span class="st">"Front.Femur_length"</span>, <span class="st">"Hind.Femur_length"</span>, <span class="st">"Front.Femur_width"</span>,
                         <span class="st">"Hind.Femur_width"</span>, <span class="st">"Rostrum_length"</span>, <span class="st">"Rostrum_width"</span>, 
                         <span class="st">"Wing_length"</span>, <span class="st">"Wing_width"</span><span class="op">)</span>,
              taxa <span class="op">=</span> <span class="st">"SpeciesID"</span>,
              occurrences <span class="op">=</span> <span class="st">"ID"</span>
              <span class="op">)</span>

<span class="co"># show different trait measurements for same occurrence/individual</span>
<span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dataset2</span>, <span class="va">occurrenceID</span> <span class="op">==</span> <span class="st">"5"</span> <span class="op">)</span> </code></pre></div>
<p>This allows the user to be explicit about the structure of the output data.</p>
</div>
<div id="specify-units" class="section level2">
<h2 class="hasAnchor">
<a href="#specify-units" class="anchor"></a>specify units</h2>
<p>For a standardisation of quantitative trait data, the unit of measurement is essential. Often, this information is kept in the metadata descriptions. But for a standardised table containing measurements from different sources, this information should always accompany the measurement value. The ETS suggests the term <code>verbatimTraitUnit</code> to contain the original author’s unit for each measurement in the data table.</p>
<p>The function <code><a href="../reference/as.traitdata.html">as.traitdata()</a></code> creates this column via its parameter <code>units</code> (see example above). This can be done for all traits in a single stroke (if all reported values refer to the same unit) or to each trait specifically (if they used different measurement units or if the table comprises a mixture of quantitative and qualitative traits).<br>
Accordingly, the parameter <code>units</code> takes a single character string, or a vector of character strings, containing valid entries as expected by the package ‘units’ <span class="citation">(Pebesma et al., 2016, <a href="https://github.com/r-quantities/units" class="uri" role="doc-biblioref">https://github.com/r-quantities/units</a>)</span>. Examples are ‘mm’, ‘m2’ or ‘m^2’, ‘m/s’.</p>
</div>
<div id="keep-additional-information" class="section level2">
<h2 class="hasAnchor">
<a href="#keep-additional-information" class="anchor"></a>keep additional information</h2>
<p>The raw data might contain further information on the individuals or the trait measurement itself in further data columns that are valuable for later analysis. This can be for instance data about the sex or developmental stage of the individual, the sampling or preservation method of the specimen, or the conditions under which the measurement was taken.</p>
<p>The parameter <code>keep</code> allows you to specify which columns contain valuable information as a character vector. As a negative version of <code>keep</code>, specifying <code>drop</code> would allow you to name the columns that are not valuable, while all others will be kept. Not specifying <code>keep</code> or <code>drop</code> will result in dropping all columns except the core measurement and identifier columns.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.traitdata.html">as.traitdata</a></span><span class="op">(</span><span class="va">heteroptera_raw</span>,
              traits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Body_length"</span>, <span class="st">"Body_width"</span>, <span class="st">"Body_height"</span>, <span class="st">"Thorax_length"</span>,
                         <span class="st">"Thorax_width"</span>, <span class="st">"Head_width"</span>, <span class="st">"Eye_width"</span>, <span class="st">"Antenna_Seg1"</span>,
                         <span class="st">"Antenna_Seg2"</span>, <span class="st">"Antenna_Seg3"</span>, <span class="st">"Antenna_Seg4"</span>, <span class="st">"Antenna_Seg5"</span>,
                         <span class="st">"Front.Tibia_length"</span>, <span class="st">"Mid.Tibia_length"</span>, <span class="st">"Hind.Tibia_length"</span>,
                         <span class="st">"Front.Femur_length"</span>, <span class="st">"Hind.Femur_length"</span>, <span class="st">"Front.Femur_width"</span>,
                         <span class="st">"Hind.Femur_width"</span>, <span class="st">"Rostrum_length"</span>, <span class="st">"Rostrum_width"</span>, 
                         <span class="st">"Wing_length"</span>, <span class="st">"Wing_width"</span><span class="op">)</span>,
              taxa <span class="op">=</span> <span class="st">"SpeciesID"</span>,
              occurrences <span class="op">=</span> <span class="st">"ID"</span>,
              keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Sex"</span><span class="op">)</span>
              <span class="op">)</span>
<span class="co">#&gt; Input is taken to be an occurrence table/an observation -- trait matrix </span>
<span class="co">#&gt; (i.e. with individual specimens per row and multiple trait measurements in columns). </span>
<span class="co">#&gt; If this is not the case, please provide parameters!</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataset2</span><span class="op">)</span> 
<span class="co">#&gt;   verbatimScientificName verbatimTraitName verbatimTraitValue verbatimTraitUnit</span>
<span class="co">#&gt; 1       Acalypta nigrina       Body_length               2.35                mm</span>
<span class="co">#&gt; 2       Acalypta nigrina       Body_length               2.10                mm</span>
<span class="co">#&gt; 3       Acalypta nigrina       Body_length               2.17                mm</span>
<span class="co">#&gt; 4       Acalypta nigrina       Body_length               2.15                mm</span>
<span class="co">#&gt; 5       Acalypta parvula       Body_length               1.84                mm</span>
<span class="co">#&gt; 6       Acalypta parvula       Body_length               1.81                mm</span>
<span class="co">#&gt;   measurementID occurrenceID Sex</span>
<span class="co">#&gt; 1             1            1   f</span>
<span class="co">#&gt; 2             2            2   f</span>
<span class="co">#&gt; 3             3            3   m</span>
<span class="co">#&gt; 4             4            4   m</span>
<span class="co">#&gt; 5             5            5   f</span>
<span class="co">#&gt; 6             6            6   f</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This trait-dataset contains 23 traits for 179 taxa ( 9386 measurements in total).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  heteroptera : Heteroptera morphometry traits by Martin M. Gossner .</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     When using these data, you must acknowledge the following usage policies: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Cite this trait dataset as: </span>
<span class="co">#&gt; Gossner MM, Simons NK, Hoeck L, Weisser WW (2015). "Morphometric</span>
<span class="co">#&gt; measures of Heteroptera sampled in grasslands across three regions of</span>
<span class="co">#&gt; Germany." _Ecology_, *96*, 1154. doi: 10.1890/14-2159.1 (URL:</span>
<span class="co">#&gt; https://doi.org/10.1890/14-2159.1).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Published under: http://creativecommons.org/publicdomain/zero/1.0/ </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     This dataset conforms to: [1] "Ecological Trait-data Standard (ETS) v0.10"</span></code></pre></div>
<p>The three extensions of the ETS provide standard terms for this kind of information:</p>
<ul>
<li>The <a href="https://terminologies.gfbio.org/terms/ets/pages/#extension-taxon"><code>Taxon</code> extension</a> provides further terms for specifying the taxonomic resolution of the observation and to ensure the correct reference in case of synonyms and homonyms.</li>
<li>The <a href="https://terminologies.gfbio.org/terms/ets/pages/#extension-measurement-or-fact"><code>Measurement Or Fact</code> extension</a> provides terms to describe information at the level of single measurements or reported facts, such as the original literature reference for the reported value, the method of measurement or statistical method of aggregation. It provides important information that allows for the tracking of potential sources of noise or bias in measured data (e.g. variation in measurement method) or aggregated values (e.g. statistical method), as well as the source of reported facts (e.g. literature source or expert reference).</li>
<li>The <a href="https://terminologies.gfbio.org/terms/ets/pages/#extension-occurrence"><code>Occurrence</code> extension</a> contains vocabulary to describe information on the observation context of individual specimens, such as sex, life stage or age. This also includes the method of sampling and preservation, as well as the date and geographical location, which provide an important resource to analyze trait variation due to differences in space and time.</li>
</ul>
<p>We highly recommend mapping the input columns into these standard terms by providing a named vector for <code>keep</code> that gives the target ETS terms as vector names.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.traitdata.html">as.traitdata</a></span><span class="op">(</span><span class="va">heteroptera_raw</span>,
              traits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Body_length"</span>, <span class="st">"Body_width"</span>, <span class="st">"Body_height"</span>, <span class="st">"Thorax_length"</span>,
                         <span class="st">"Thorax_width"</span>, <span class="st">"Head_width"</span>, <span class="st">"Eye_width"</span>, <span class="st">"Antenna_Seg1"</span>,
                         <span class="st">"Antenna_Seg2"</span>, <span class="st">"Antenna_Seg3"</span>, <span class="st">"Antenna_Seg4"</span>, <span class="st">"Antenna_Seg5"</span>,
                         <span class="st">"Front.Tibia_length"</span>, <span class="st">"Mid.Tibia_length"</span>, <span class="st">"Hind.Tibia_length"</span>,
                         <span class="st">"Front.Femur_length"</span>, <span class="st">"Hind.Femur_length"</span>, <span class="st">"Front.Femur_width"</span>,
                         <span class="st">"Hind.Femur_width"</span>, <span class="st">"Rostrum_length"</span>, <span class="st">"Rostrum_width"</span>, 
                         <span class="st">"Wing_length"</span>, <span class="st">"Wing_width"</span><span class="op">)</span>,
              taxa <span class="op">=</span> <span class="st">"SpeciesID"</span>,
              occurrences <span class="op">=</span> <span class="st">"ID"</span>,
              units <span class="op">=</span> <span class="st">"mm"</span>,
              keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>order <span class="op">=</span> <span class="st">"Order"</span>, family <span class="op">=</span> <span class="st">"Family"</span>, 
                       sex <span class="op">=</span> <span class="st">"Sex"</span>, lifeStage <span class="op">=</span> <span class="st">"Wing_development"</span>, 
                       basisOfRecordDescription <span class="op">=</span> <span class="st">"Source"</span>, 
                       verbatimLocality <span class="op">=</span> <span class="st">"Center_Sampling_region"</span>, 
                       references <span class="op">=</span> <span class="st">"Voucher_ID"</span> <span class="op">)</span>
<span class="op">)</span>
<span class="co">#&gt; Input is taken to be an occurrence table/an observation -- trait matrix </span>
<span class="co">#&gt; (i.e. with individual specimens per row and multiple trait measurements in columns). </span>
<span class="co">#&gt; If this is not the case, please provide parameters!</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataset2</span><span class="op">)</span>
<span class="co">#&gt;   verbatimScientificName verbatimTraitName verbatimTraitValue verbatimTraitUnit</span>
<span class="co">#&gt; 1       Acalypta nigrina       Body_length               2.35                mm</span>
<span class="co">#&gt; 2       Acalypta nigrina       Body_length               2.10                mm</span>
<span class="co">#&gt; 3       Acalypta nigrina       Body_length               2.17                mm</span>
<span class="co">#&gt; 4       Acalypta nigrina       Body_length               2.15                mm</span>
<span class="co">#&gt; 5       Acalypta parvula       Body_length               1.84                mm</span>
<span class="co">#&gt; 6       Acalypta parvula       Body_length               1.81                mm</span>
<span class="co">#&gt;   measurementID occurrenceID     order   family</span>
<span class="co">#&gt; 1             1            1 Hemiptera Tingidae</span>
<span class="co">#&gt; 2             2            2 Hemiptera Tingidae</span>
<span class="co">#&gt; 3             3            3 Hemiptera Tingidae</span>
<span class="co">#&gt; 4             4            4 Hemiptera Tingidae</span>
<span class="co">#&gt; 5             5            5 Hemiptera Tingidae</span>
<span class="co">#&gt; 6             6            6 Hemiptera Tingidae</span>
<span class="co">#&gt;             basisOfRecordDescription</span>
<span class="co">#&gt; 1 Zoological State Collection Munich</span>
<span class="co">#&gt; 2 Zoological State Collection Munich</span>
<span class="co">#&gt; 3 Zoological State Collection Munich</span>
<span class="co">#&gt; 4 Zoological State Collection Munich</span>
<span class="co">#&gt; 5 Zoological State Collection Munich</span>
<span class="co">#&gt; 6 Zoological State Collection Munich</span>
<span class="co">#&gt;                                     references sex lifeStage  verbatimLocality</span>
<span class="co">#&gt; 1      Treuchtlingen_leg.Seidenstücker_21.5.48   f         m 48°57’ N 10°55’ E</span>
<span class="co">#&gt; 2            Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 3 Gunzenshausen_Mfr._leg.Seidenstücker_15.4.58   m         m 49°07’ N 10°45’ E</span>
<span class="co">#&gt; 4            Nürnberg_leg.Seidenstücker_9.7.44   m         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 5                Nürnberg_Seidenstücker_4.8.45   f         m 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 6               Erlangen_Seidenstücker_30.9.40   f         b 49°36’ N 11°00’ E</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This trait-dataset contains 23 traits for 179 taxa ( 9386 measurements in total).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  heteroptera : Heteroptera morphometry traits by Martin M. Gossner .</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     When using these data, you must acknowledge the following usage policies: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Cite this trait dataset as: </span>
<span class="co">#&gt; Gossner MM, Simons NK, Hoeck L, Weisser WW (2015). "Morphometric</span>
<span class="co">#&gt; measures of Heteroptera sampled in grasslands across three regions of</span>
<span class="co">#&gt; Germany." _Ecology_, *96*, 1154. doi: 10.1890/14-2159.1 (URL:</span>
<span class="co">#&gt; https://doi.org/10.1890/14-2159.1).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Published under: http://creativecommons.org/publicdomain/zero/1.0/ </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     This dataset conforms to: [1] "Ecological Trait-data Standard (ETS) v0.10"</span></code></pre></div>
<p>Note that a lack of a name in the named vector maintains the original name. Note also, that no checking for valid column names (as compared to the traitdata glossary) is performed at this stage. This is to ensure that the raw data table created by <code>as.traittable()</code> can contain any columns that the author considers relevant. The <code>keep</code> parameter can be used to rename columns into intuitive column names.</p>
<!--
## case example: adding further information on traits, species or single measurements

Beyond measurement units, further information might be available that are not recorded in the raw data table, but are related to the trait type, the taxon, the individual or specimen, or to the reported fact, measurement or sampling event. 

In most cases those information are kept in seperate data sheets of your file, e.g. the place were a specimen has been sampled or the literature source from where a species value has been cited. In this case, a unique identifier might link to this other datasheet, such as a number for each individual occurrence of a specimen (`occurrenceID`) or an identifier for a single measurement or reported fact (`measurementID`). 

The trait data standard  provides two extensions of the namespace that should be used to describe these data:

- the `occurrence` extension contains information on the level of individual specimens, such as date and location and method of sampling and preservation, or physiological specifications of the phenotype, such as sex, life stage or age. 
- the `measurementOrFact` extension takes information at the level of single measurements or reported values, such as the original literature from where the value is cited, the method of measurement or statistical method of aggregation. 

The extensions are compatible with Darwin Core Standard and EOL TraitBank.  

You may decide to keep the information in a seperate data sheet. In that case, the traitdata table should at least contain a column with the respective identifier that directs to the covariate datasheet. The identifier might also take the format of a globally valid URI or API call.

It is however recommended to add these information directly as own columns within the data table to enable an analysis of cofactors and correlations further down the road. This way, if datasets of different source are merged, the information is readily available without the risk of breaking the reference to an external datasheet. 

The function `as.traitdata()` provides a set of parameters to add information at the different levels. The following three examples will illustrate how to add covariates to each occurrence or  measurement.  The principle is always the same: A unique identifier for these levels of information can be associated with a vector or data table containing the additional information, which will then be merged into the data table. The functionality builds on the base R function `merge.data.frame`, but checks for compatibility with the glossary of terms of the traitdata standard. 


### Adding information on specimen level (occurrence Extension)

- under construction - 

### Adding information on measurement or fact (measurementOrFact Extension)

- under construction -
 -->
</div>
<div id="derived-trait-values" class="section level2">
<h2 class="hasAnchor">
<a href="#derived-trait-values" class="anchor"></a>derived trait-values</h2>
<p>Many traits comprise compound measures of multiple traits, such as length-mass ratios or morphometric indices. Other traits must be refined in terms of factor levels, or reduced to binary trait values. Many of these tasks can be achieved on the matrix raw data using base functions like <code><a href="https://rdrr.io/r/base/transform.html">transform()</a></code>, <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> or <code><a href="https://rdrr.io/r/base/match.html">match()</a></code> or the <code>mutate()</code> function provided by the package ‘plyr’ before conversion into the long-table format.</p>
<p>However, if the data are converted to long-table format, these tasks may become tedious as they require splitting the data before the computation can be done. The function <code><a href="../reference/mutate.traitdata.html">mutate.traitdata()</a></code> performs these tasks (working as a wrapper to <code><a href="https://rdrr.io/pkg/plyr/man/mutate.html">plyr::mutate()</a></code>) while keeping an eye on the units.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mutate.traitdata.html">mutate.traitdata</a></span><span class="op">(</span><span class="va">dataset2</span>, 
                            Body_shape <span class="op">=</span> <span class="va">Body_length</span><span class="op">/</span><span class="va">Body_width</span>, 
                            Body_volume <span class="op">=</span> <span class="va">Body_length</span><span class="op">*</span><span class="va">Body_width</span><span class="op">*</span><span class="va">Body_height</span>,
                            Wingload <span class="op">=</span> <span class="va">Wing_length</span><span class="op">*</span><span class="va">Wing_width</span><span class="op">/</span><span class="va">Body_volume</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataset2</span><span class="op">[</span><span class="va">dataset2</span><span class="op">$</span><span class="va">verbatimTraitName</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Body_shape"</span>, <span class="st">"Body_volume"</span>, <span class="st">"Wingload"</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;      verbatimScientificName verbatimTraitName verbatimTraitValue</span>
<span class="co">#&gt; 9387       Acalypta nigrina        Body_shape           2.043478</span>
<span class="co">#&gt; 9388       Acalypta nigrina        Body_shape           1.721311</span>
<span class="co">#&gt; 9389       Acalypta nigrina        Body_shape           2.028037</span>
<span class="co">#&gt; 9390       Acalypta nigrina        Body_shape           2.067308</span>
<span class="co">#&gt; 9391       Acalypta parvula        Body_shape           2.243902</span>
<span class="co">#&gt; 9392       Acalypta parvula        Body_shape           1.885417</span>
<span class="co">#&gt;      verbatimTraitUnit measurementID occurrenceID     order   family</span>
<span class="co">#&gt; 9387                 1          &lt;NA&gt;            1 Hemiptera Tingidae</span>
<span class="co">#&gt; 9388                 1          &lt;NA&gt;            2 Hemiptera Tingidae</span>
<span class="co">#&gt; 9389                 1          &lt;NA&gt;            3 Hemiptera Tingidae</span>
<span class="co">#&gt; 9390                 1          &lt;NA&gt;            4 Hemiptera Tingidae</span>
<span class="co">#&gt; 9391                 1          &lt;NA&gt;            5 Hemiptera Tingidae</span>
<span class="co">#&gt; 9392                 1          &lt;NA&gt;            6 Hemiptera Tingidae</span>
<span class="co">#&gt;                basisOfRecordDescription</span>
<span class="co">#&gt; 9387 Zoological State Collection Munich</span>
<span class="co">#&gt; 9388 Zoological State Collection Munich</span>
<span class="co">#&gt; 9389 Zoological State Collection Munich</span>
<span class="co">#&gt; 9390 Zoological State Collection Munich</span>
<span class="co">#&gt; 9391 Zoological State Collection Munich</span>
<span class="co">#&gt; 9392 Zoological State Collection Munich</span>
<span class="co">#&gt;                                        references sex lifeStage</span>
<span class="co">#&gt; 9387      Treuchtlingen_leg.Seidenstücker_21.5.48   f         m</span>
<span class="co">#&gt; 9388            Nürnberg_leg.Seidenstücker_9.7.44   f         b</span>
<span class="co">#&gt; 9389 Gunzenshausen_Mfr._leg.Seidenstücker_15.4.58   m         m</span>
<span class="co">#&gt; 9390            Nürnberg_leg.Seidenstücker_9.7.44   m         b</span>
<span class="co">#&gt; 9391                Nürnberg_Seidenstücker_4.8.45   f         m</span>
<span class="co">#&gt; 9392               Erlangen_Seidenstücker_30.9.40   f         b</span>
<span class="co">#&gt;       verbatimLocality</span>
<span class="co">#&gt; 9387 48°57’ N 10°55’ E</span>
<span class="co">#&gt; 9388 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 9389 49°07’ N 10°45’ E</span>
<span class="co">#&gt; 9390 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 9391 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 9392 49°36’ N 11°00’ E</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This trait-dataset contains 26 traits for 179 taxa ( 9386 measurements in total).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  heteroptera : Heteroptera morphometry traits by Martin M. Gossner .</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     When using these data, you must acknowledge the following usage policies: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Cite this trait dataset as: </span>
<span class="co">#&gt; Gossner MM, Simons NK, Hoeck L, Weisser WW (2015). "Morphometric</span>
<span class="co">#&gt; measures of Heteroptera sampled in grasslands across three regions of</span>
<span class="co">#&gt; Germany." _Ecology_, *96*, 1154. doi: 10.1890/14-2159.1 (URL:</span>
<span class="co">#&gt; https://doi.org/10.1890/14-2159.1).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Published under: http://creativecommons.org/publicdomain/zero/1.0/ </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     This dataset conforms to: [1] "Ecological Trait-data Standard (ETS) v0.10"</span></code></pre></div>
<p>Note that all existing traits remain untouched and additional trait measures will be added to the dataset, unless a definition replaces an already existing trait.</p>
<p>It is important to note that the mutate function works at the level of data resolution that is provided by the data, i.e. for occurrence data with multiple measurements on a single individual, the data columns are mutated per <code>occurrenceID</code>.</p>
</div>
</div>
<div id="standardize-traits" class="section level1">
<h1 class="hasAnchor">
<a href="#standardize-traits" class="anchor"></a>2. Standardize traits</h1>
<p>The function <code><a href="../reference/as.traitdata.html">as.traitdata()</a></code> produced a tidy and correctly formatted version of your own trait data. We now turn to the challenging task of standardisation.</p>
<p>The field <code>traitID</code> is meant to contain a globally valid reference to a trait definition that applies to the measurement in question. Due to the heterogeneity of approaches, research questions and taxonomic focus in trait-based research, it is hard to come up with universal trait definitions that can be employed in each and every research context. The mode of measurement or the precise prescriptions of a sampling procedure have been formalized into published handbooks, <span class="citation">(e.g. Cornelissen et al., 2003; Perez-Harguindeguy et al., 2013; or for invertebrates, Moretti et al., 2017)</span>, but are of limited use in harmonising trait data that pre-date or ignore this standard. Thesauri, e.g. the TOP Thesaurus of plant traits <span class="citation">(Garnier et al., 2017, employed by TRY)</span> or Gramene.org offer definitions of plant traits in a formal language. For soil invertebrates, the T-SITA thesaurus offers a set of traits relevant for this organism group <span class="citation">(see Schneider et al., 2018 for a more detailed distinction of thesauri and ontologies)</span>. All in all, only for few organism groups and trait methodologies exist Unique Resource Identifiers (URIs) that provide a stable reference to an unambiguous definition and can be referenced from the dataset.</p>
<div id="refer-to-trait-definitions-via-uris" class="section level3">
<h3 class="hasAnchor">
<a href="#refer-to-trait-definitions-via-uris" class="anchor"></a>Refer to trait definitions via URIs</h3>
<p>Thus, the key information must be provided manually as an own data object in R. However, <code>traitdataform</code> assists in creating an own reference list of traits, a so called ‘thesaurus’, that will be used to feed trait definitions, units or identifiers into the dataset.</p>
<p>The function to create an object of class ‘thesaurus’ is <code><a href="../reference/as.thesaurus.html">as.thesaurus()</a></code> and deals with several objects created by <code><a href="../reference/as.trait.html">as.trait()</a></code>. The ETS provides a <a href="https://terminologies.gfbio.org/terms/ets/pages/#terms-for-trait-definitions">set of terms to describe trait concepts</a> which can be provided as an input parameter to <code>as.traits()</code>. Using the <code><a href="../reference/as.trait.html">as.trait()</a></code> function allows assigning flexible trait definition while ensuring compliance with the terms of the traitdata standard outlined above. It also allows building a library of trait definitions where single traits can be reused in multiple projects.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"body_length"</span>,
         expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
         traitDescription <span class="op">=</span> <span class="st">"The known longest dimension of the physical structure of organisms"</span>,
         identifier <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Body_length"</span>,
         author <span class="op">=</span> <span class="st">"Maggenti and Maggenti, 2005"</span>,
         broaderTerm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Body_dimension"</span><span class="op">)</span>,
         narrowerTerm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Female_body_length"</span>,
                          <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Male_body_length"</span><span class="op">)</span>
         <span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  body_length :</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Defined as: The known longest dimension of the physical structure of</span>
<span class="co">#&gt;          organisms</span>
<span class="co">#&gt;           </span>
<span class="co">#&gt;  Broader term: http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Body_dimension</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Narrower term: http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Female_body_length;</span>
<span class="co">#&gt;          http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Male_body_length</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Value type:  numeric </span>
<span class="co">#&gt;  Expected unit:  mm </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Body_length</span></code></pre></div>
<p>E.g. if <em>all</em> of the traits reported in your dataset refer to a definition published under a publicly available identifier, the thesaurus could be created like this:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">thesaurus1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.thesaurus.html">as.thesaurus</a></span><span class="op">(</span>
          body_length <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"body_length"</span>,
                  expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                  identifier <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Body_length"</span><span class="op">)</span>,
          antenna_length <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"antenna_length"</span>,
                  expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                  identifier <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Antenna_length"</span><span class="op">)</span>,
          metafemur_length <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"femur_length"</span>,
                  expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                  identifier <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Femur_length"</span><span class="op">)</span>,
          eyewidth_corr <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"eye_diameter"</span>,
                  expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                  identifier <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Eye_diameter"</span><span class="op">)</span>
        <span class="op">)</span></code></pre></div>
<p>Alternatively, a thesaurus can be created from a <code>data.frame</code>, which might be easier if only trait name and identifier are to be provided and more specific trait definitions are not to be stored in the R object.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">thesaurus1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.thesaurus.html">as.thesaurus</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
                      trait <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"body_length"</span>,  <span class="st">"antenna_length"</span>, <span class="st">"metafemur_length"</span>, <span class="st">"eyewidth_corr"</span><span class="op">)</span>,
                      identifier <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait="</span>, 
                                          <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Body_length"</span>, <span class="st">"Antenna_length"</span>, <span class="st">"Femur_length"</span>, <span class="st">"Eye_diameter"</span><span class="op">)</span><span class="op">)</span>, 
                      valueType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"numeric"</span><span class="op">)</span>,
                      expectedUnit <span class="op">=</span> <span class="st">"mm"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>To transfer the user-provided traits and trait values into standardised values, the function <code><a href="../reference/standardize_traits.html">standardize_traits()</a></code> merges the data table with a reference table of trait definitions to produce values of a compliant format.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset1Std</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/standardize_traits.html">standardize_traits</a></span><span class="op">(</span><span class="va">dataset1</span>, <span class="va">thesaurus1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataset1Std</span><span class="op">)</span>
<span class="co">#&gt;   traitID   traitName traitValue traitUnit verbatimScientificName</span>
<span class="co">#&gt; 1       2 body_length  15.846561        mm  Abax_parallelepipedus</span>
<span class="co">#&gt; 2       2 body_length   2.670000        mm   Acupalpus_meridianus</span>
<span class="co">#&gt; 3       2 body_length   5.873016        mm         Agonum_ericeti</span>
<span class="co">#&gt; 4       2 body_length   5.090000        mm     Agonum_fuliginosum</span>
<span class="co">#&gt; 5       2 body_length   4.880000        mm         Agonum_gracile</span>
<span class="co">#&gt; 6       2 body_length   8.250000        mm      Agonum_marginatum</span>
<span class="co">#&gt;   verbatimTraitName verbatimTraitValue verbatimTraitUnit measurementID</span>
<span class="co">#&gt; 1       body_length          15.846561                mm             1</span>
<span class="co">#&gt; 2       body_length           2.670000                mm             2</span>
<span class="co">#&gt; 3       body_length           5.873016                mm             3</span>
<span class="co">#&gt; 4       body_length           5.090000                mm             4</span>
<span class="co">#&gt; 5       body_length           4.880000                mm             5</span>
<span class="co">#&gt; 6       body_length           8.250000                mm             6</span>
<span class="co">#&gt;   measurementDeterminedBy measurementRemarks</span>
<span class="co">#&gt; 1                   klink               &lt;NA&gt;</span>
<span class="co">#&gt; 2                WOODCOCK               &lt;NA&gt;</span>
<span class="co">#&gt; 3                   klink               &lt;NA&gt;</span>
<span class="co">#&gt; 4                  ribera               &lt;NA&gt;</span>
<span class="co">#&gt; 5                  ribera deduced_from_genus</span>
<span class="co">#&gt; 6                  ribera               &lt;NA&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This trait-dataset contains 4 traits for 120 taxa ( 480 measurements in total).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  carabids : Carabid traits by Fons van der Plas .</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     When using these data, you must acknowledge the following usage policies: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Cite this trait dataset as: </span>
<span class="co">#&gt; van der Plas F, van Klink R, Manning P, Olff H, Fischer M (2017).</span>
<span class="co">#&gt; "Sensitivity of functional diversity metrics to sampling intensity."</span>
<span class="co">#&gt; _Methods in Ecology and Evolution_. doi: 10.1111/2041-210x.12728 (URL:</span>
<span class="co">#&gt; https://doi.org/10.1111/2041-210x.12728).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Published under: http://creativecommons.org/publicdomain/zero/1.0/ </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     This dataset conforms to: [1] "Ecological Trait-data Standard (ETS) v0.10"</span></code></pre></div>
<p>The output table now contains a duplicate record of the originally provided trait measurements (in <code>verbatimTraitName</code>, <code>verbatimTraitValue</code> and <code>verbatimTraitUnit</code>) and now being standardised into target terms and units as requested by the thesaurus.</p>
</div>
<div id="refer-to-own-trait-definitions" class="section level3">
<h3 class="hasAnchor">
<a href="#refer-to-own-trait-definitions" class="anchor"></a>refer to own trait definitions</h3>
<p>If no published trait concept can be referenced, trait-datasets should be accompanied by a dataset-specific thesaurus. Ideally this is stored as an asset along with your trait dataset in the same data publication or in a separate publication. This can be a csv or txt file, or a website providing direct and stable links to each trait definition.</p>
<p>This reference file should contain at least the following fields for each trait concept:</p>
<ul>
<li>
<code>trait</code> should be a short descriptive name. No spaces should be used. Rather use a scheme with underscore or capital letters to highlight multiple words (e.g. ‘body_length’ or ‘bodyLenght’).</li>
<li>
<code>traitDescription</code>: a detailed and unambiguous, human readable definition.</li>
<li>
<code>valueType</code> to specify the expected kind of entries. Set it to ‘numeric’ for quantitative traits, ‘integer’ for counts or ordinal traits, ‘character’ for trait values that are provided as free text, ‘factor’ for traits that take one of few non-ordinal levels, ‘logical’ for binary/boolean entries (yes/no).
<ul>
<li>For <em>numeric traits</em>, the parameter <code>expectedUnit</code> should provide the expected unit for the trait. The R script will then try to convert trait values into this unit.</li>
<li>for <em>categorical traits</em> of kind ‘factor’ or ‘integer’, the field <code>factorLevels</code> should contain a list the valid factorial traits separated by semicolon. In case of ordinal traits, the order must be precisely corresponding to the number of possible integer values.</li>
</ul>
</li>
<li>
<code>comments</code> may contain examples and clarifications</li>
<li>optionally, <code>identifier</code> may specify an alphanumeric ID for the specific use in your dataset, but this function is also covered by having defined unambiguous trait labels in field <code>trait</code> which recur in field <code>verbatimTraitName</code> of the main dataset.</li>
</ul>
<p>Refer to the <a href="https://terminologies.gfbio.org/terms/ets/pages/#terms-for-trait-definitions">ETS set of terms to describe trait concepts</a>) for further definitions of these terms, as well as the <a href="https://terminologies.gfbio.org/terms/ets/pages/bestpractice.html">best practice guidelines for trait-data publications</a>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># M. Gossner, Martin; K. Simons, Nadja; Hoeck, Leonhard; W. Weisser, Wolfgang</span>
<span class="co"># (2016): Morphometric measures of Heteroptera sampled in grasslands across</span>
<span class="co"># three regions of Germany. figshare.</span>
<span class="co"># https://doi.org/10.6084/m9.figshare.c.3307611.v1 </span>
<span class="co"># following the definitions in data publication </span>
<span class="co"># http://www.esapubs.org/archive/ecol/E096/102/metadata.php</span>

<span class="va">thesaurus2</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/as.thesaurus.html">as.thesaurus</a></span><span class="op">(</span>
    Body_length <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Body_length"</span>, identifier <span class="op">=</span> <span class="st">"t1"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"From the tip of the head to the end of the abdomen"</span><span class="op">)</span>,
    Body_width <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Body_width"</span>, identifier <span class="op">=</span> <span class="st">"t2"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Widest part of the body"</span><span class="op">)</span>,
    Body_height <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Body_height"</span>,identifier <span class="op">=</span> <span class="st">"t3"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Thickest part of the body"</span><span class="op">)</span>,
    Thorax_length <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Thorax_length"</span>, identifier <span class="op">=</span> <span class="st">"t4"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Longest part of the pronotum"</span><span class="op">)</span>,
    Thorax_width <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Thorax_width"</span>, identifier <span class="op">=</span> <span class="st">"t5"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Widest part of the pronotum"</span><span class="op">)</span>,
    Head_width <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Head_width"</span>, identifier <span class="op">=</span> <span class="st">"t6"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Widest part of the head including eyes"</span><span class="op">)</span>,
    Eye_width <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Eye_width"</span>, identifier <span class="op">=</span> <span class="st">"t7"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Widest part of the left eye"</span><span class="op">)</span>,
    Antenna_Seg1 <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Antenna_Seg1"</span>, identifier <span class="op">=</span> <span class="st">"t8"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Length of first antenna segment"</span>,
                            broaderTerm <span class="op">=</span> <span class="st">"http://ecologicaltraitdata.github.io/TraitDataList/Antenna_length"</span><span class="op">)</span>,
    Antenna_Seg2 <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Antenna_Seg2"</span>, identifier <span class="op">=</span> <span class="st">"t9"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Length of second antenna segment"</span>,
                            broaderTerm <span class="op">=</span> <span class="st">"http://ecologicaltraitdata.github.io/TraitDataList/Antenna_length"</span><span class="op">)</span>,
    Antenna_Seg3 <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Antenna_Seg3"</span>, identifier <span class="op">=</span> <span class="st">"t10"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Length of third antenna segment"</span>,
                            broaderTerm <span class="op">=</span> <span class="st">"http://ecologicaltraitdata.github.io/TraitDataList/Antenna_length"</span><span class="op">)</span>,
    Antenna_Seg4 <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Antenna_Seg4"</span>, identifier <span class="op">=</span> <span class="st">"t11"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Length of fourth antenna segment"</span>,
                            broaderTerm <span class="op">=</span> <span class="st">"http://ecologicaltraitdata.github.io/TraitDataList/Antenna_length"</span><span class="op">)</span>,
    Antenna_Seg5 <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Antenna_Seg5"</span>, identifier <span class="op">=</span> <span class="st">"t12"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Length of fifth antenna segment (only Pentatomoidea)"</span>,
                            broaderTerm <span class="op">=</span> <span class="st">"http://ecologicaltraitdata.github.io/TraitDataList/Antenna_length"</span><span class="op">)</span>,
    Front.Tibia_length <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Front.Tibia_length"</span>, identifier <span class="op">=</span> <span class="st">"t13"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Length of the tibia of the foreleg"</span><span class="op">)</span>,
    Mid.Tibia_length <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Mid.Tibia_length"</span>, identifier <span class="op">=</span> <span class="st">"t14"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Length of the tibia of the mid leg"</span>,
                            broaderTerm <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Tibia_length"</span><span class="op">)</span>,
    Hind.Tibia_length <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Hind.Tibia_length"</span>, identifier <span class="op">=</span> <span class="st">"t15"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Length of the tibia of the hind leg"</span>,
                            broaderTerm <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Tibia_length"</span><span class="op">)</span>,
    Front.Femur_length <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Front.Femur_length"</span>, identifier <span class="op">=</span> <span class="st">"t16"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Length of the femur of the foreleg"</span>,
                            broaderTerm <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Femur_length"</span><span class="op">)</span>,
    Hind.Femur_length <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Hind.Femur_length"</span>, identifier <span class="op">=</span> <span class="st">"t17"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Length of the femur of the hind leg"</span>,
                            broaderTerm <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Femur_length"</span><span class="op">)</span>,
    Front.Femur_width <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Front.Femur_width"</span>, identifier <span class="op">=</span> <span class="st">"t18"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Width of the femur of the foreleg"</span><span class="op">)</span>,
    Hind.Femur_width <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Hind.Femur_width"</span>, identifier <span class="op">=</span> <span class="st">"t18"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Width of the femur of the hind leg"</span><span class="op">)</span>,
    Rostrum_length <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Rostrum_length"</span>, identifier <span class="op">=</span> <span class="st">"t19"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Length of the rostrum including all segments"</span><span class="op">)</span>,
    Rostrum_width <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Rostrum_width"</span>, identifier <span class="op">=</span> <span class="st">"t20"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Widest part of the rostrum"</span><span class="op">)</span>,
    Wing_length <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Wing_length"</span>, identifier <span class="op">=</span> <span class="st">"t21"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Longest part of the forewing"</span>,
                            broaderTerm <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Wing"</span><span class="op">)</span>,
    Wing_width <span class="op">=</span> <span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"Wing_width"</span>, identifier <span class="op">=</span> <span class="st">"t22"</span>,
                            expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                            traitDescription <span class="op">=</span> <span class="st">"Widest part of the forewing"</span>,
                            broaderTerm <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Wing"</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p>Applying <code><a href="../reference/standardize_traits.html">standardize_traits()</a></code> will refer to this dataset-specific thesaurus and append it as an attribute to the R object.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset2Std</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/standardize_traits.html">standardize_traits</a></span><span class="op">(</span><span class="va">dataset2</span>, <span class="va">thesaurus2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">dataset2Std</span>, <span class="va">occurrenceID</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;      traitID          traitName traitValue traitUnit verbatimScientificName</span>
<span class="co">#&gt; 185        1        Body_length       2.10        mm       Acalypta nigrina</span>
<span class="co">#&gt; 610        2         Body_width       1.22        mm       Acalypta nigrina</span>
<span class="co">#&gt; 871        3        Body_height       0.67        mm       Acalypta nigrina</span>
<span class="co">#&gt; 1337       4      Thorax_length       0.24        mm       Acalypta nigrina</span>
<span class="co">#&gt; 1721       5       Thorax_width       0.95        mm       Acalypta nigrina</span>
<span class="co">#&gt; 2309       6         Head_width       0.45        mm       Acalypta nigrina</span>
<span class="co">#&gt; 2734       7          Eye_width       0.13        mm       Acalypta nigrina</span>
<span class="co">#&gt; 3364       8       Antenna_Seg1       0.12        mm       Acalypta nigrina</span>
<span class="co">#&gt; 3422       9       Antenna_Seg2       0.04        mm       Acalypta nigrina</span>
<span class="co">#&gt; 3888      10       Antenna_Seg3       0.44        mm       Acalypta nigrina</span>
<span class="co">#&gt; 4271      11       Antenna_Seg4       0.15        mm       Acalypta nigrina</span>
<span class="co">#&gt; 4895      13 Front.Tibia_length       0.40        mm       Acalypta nigrina</span>
<span class="co">#&gt; 5524      14   Mid.Tibia_length       0.42        mm       Acalypta nigrina</span>
<span class="co">#&gt; 5563      15  Hind.Tibia_length       0.56        mm       Acalypta nigrina</span>
<span class="co">#&gt; 6048      16 Front.Femur_length       0.48        mm       Acalypta nigrina</span>
<span class="co">#&gt; 6412      17  Hind.Femur_length       0.56        mm       Acalypta nigrina</span>
<span class="co">#&gt; 7021      18  Front.Femur_width       0.12        mm       Acalypta nigrina</span>
<span class="co">#&gt; 7569      19   Hind.Femur_width       0.10        mm       Acalypta nigrina</span>
<span class="co">#&gt; 7870      20     Rostrum_length       0.92        mm       Acalypta nigrina</span>
<span class="co">#&gt; 8118      21      Rostrum_width       0.08        mm       Acalypta nigrina</span>
<span class="co">#&gt; 8598      22        Wing_length       1.66        mm       Acalypta nigrina</span>
<span class="co">#&gt; 8968      23         Wing_width       0.57        mm       Acalypta nigrina</span>
<span class="co">#&gt;       verbatimTraitName verbatimTraitValue verbatimTraitUnit measurementID</span>
<span class="co">#&gt; 185         Body_length               2.10                mm             2</span>
<span class="co">#&gt; 610          Body_width               1.22                mm           427</span>
<span class="co">#&gt; 871         Body_height               0.67                mm           852</span>
<span class="co">#&gt; 1337      Thorax_length               0.24                mm          1277</span>
<span class="co">#&gt; 1721       Thorax_width               0.95                mm          1702</span>
<span class="co">#&gt; 2309         Head_width               0.45                mm          2127</span>
<span class="co">#&gt; 2734          Eye_width               0.13                mm          2552</span>
<span class="co">#&gt; 3364       Antenna_Seg1               0.12                mm          2977</span>
<span class="co">#&gt; 3422       Antenna_Seg2               0.04                mm          3402</span>
<span class="co">#&gt; 3888       Antenna_Seg3               0.44                mm          3827</span>
<span class="co">#&gt; 4271       Antenna_Seg4               0.15                mm          4252</span>
<span class="co">#&gt; 4895 Front.Tibia_length               0.40                mm          4713</span>
<span class="co">#&gt; 5524   Mid.Tibia_length               0.42                mm          5138</span>
<span class="co">#&gt; 5563  Hind.Tibia_length               0.56                mm          5563</span>
<span class="co">#&gt; 6048 Front.Femur_length               0.48                mm          5988</span>
<span class="co">#&gt; 6412  Hind.Femur_length               0.56                mm          6413</span>
<span class="co">#&gt; 7021  Front.Femur_width               0.12                mm          6838</span>
<span class="co">#&gt; 7569   Hind.Femur_width               0.10                mm          7263</span>
<span class="co">#&gt; 7870     Rostrum_length               0.92                mm          7688</span>
<span class="co">#&gt; 8118      Rostrum_width               0.08                mm          8113</span>
<span class="co">#&gt; 8598        Wing_length               1.66                mm          8538</span>
<span class="co">#&gt; 8968         Wing_width               0.57                mm          8963</span>
<span class="co">#&gt;      occurrenceID     order   family           basisOfRecordDescription</span>
<span class="co">#&gt; 185             2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 610             2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 871             2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 1337            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 1721            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 2309            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 2734            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 3364            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 3422            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 3888            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 4271            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 4895            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 5524            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 5563            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 6048            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 6412            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 7021            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 7569            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 7870            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 8118            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 8598            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt; 8968            2 Hemiptera Tingidae Zoological State Collection Munich</span>
<span class="co">#&gt;                             references sex lifeStage  verbatimLocality</span>
<span class="co">#&gt; 185  Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 610  Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 871  Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 1337 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 1721 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 2309 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 2734 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 3364 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 3422 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 3888 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 4271 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 4895 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 5524 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 5563 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 6048 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 6412 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 7021 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 7569 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 7870 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 8118 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 8598 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; 8968 Nürnberg_leg.Seidenstücker_9.7.44   f         b 49°27’ N 11°05’ E</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This trait-dataset contains 26 traits for 179 taxa ( 9386 measurements in total).</span>
<span class="co">#&gt; NULL</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">dataset2Std</span><span class="op">)</span><span class="op">$</span><span class="va">traits</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"trait"</span>, <span class="st">"identifier"</span>,<span class="st">"traitDescription"</span>,<span class="st">"expectedUnit"</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;                                 trait identifier</span>
<span class="co">#&gt; Body_length               Body_length          1</span>
<span class="co">#&gt; Body_width                 Body_width          2</span>
<span class="co">#&gt; Body_height               Body_height          3</span>
<span class="co">#&gt; Thorax_length           Thorax_length          4</span>
<span class="co">#&gt; Thorax_width             Thorax_width          5</span>
<span class="co">#&gt; Head_width                 Head_width          6</span>
<span class="co">#&gt; Eye_width                   Eye_width          7</span>
<span class="co">#&gt; Antenna_Seg1             Antenna_Seg1          8</span>
<span class="co">#&gt; Antenna_Seg2             Antenna_Seg2          9</span>
<span class="co">#&gt; Antenna_Seg3             Antenna_Seg3         10</span>
<span class="co">#&gt; Antenna_Seg4             Antenna_Seg4         11</span>
<span class="co">#&gt; Antenna_Seg5             Antenna_Seg5         12</span>
<span class="co">#&gt; Front.Tibia_length Front.Tibia_length         13</span>
<span class="co">#&gt; Mid.Tibia_length     Mid.Tibia_length         14</span>
<span class="co">#&gt; Hind.Tibia_length   Hind.Tibia_length         15</span>
<span class="co">#&gt; Front.Femur_length Front.Femur_length         16</span>
<span class="co">#&gt; Hind.Femur_length   Hind.Femur_length         17</span>
<span class="co">#&gt; Front.Femur_width   Front.Femur_width         18</span>
<span class="co">#&gt; Hind.Femur_width     Hind.Femur_width         19</span>
<span class="co">#&gt; Rostrum_length         Rostrum_length         20</span>
<span class="co">#&gt; Rostrum_width           Rostrum_width         21</span>
<span class="co">#&gt; Wing_length               Wing_length         22</span>
<span class="co">#&gt; Wing_width                 Wing_width         23</span>
<span class="co">#&gt;                                                        traitDescription</span>
<span class="co">#&gt; Body_length          From the tip of the head to the end of the abdomen</span>
<span class="co">#&gt; Body_width                                      Widest part of the body</span>
<span class="co">#&gt; Body_height                                   Thickest part of the body</span>
<span class="co">#&gt; Thorax_length                              Longest part of the pronotum</span>
<span class="co">#&gt; Thorax_width                                Widest part of the pronotum</span>
<span class="co">#&gt; Head_width                       Widest part of the head including eyes</span>
<span class="co">#&gt; Eye_width                                   Widest part of the left eye</span>
<span class="co">#&gt; Antenna_Seg1                            Length of first antenna segment</span>
<span class="co">#&gt; Antenna_Seg2                           Length of second antenna segment</span>
<span class="co">#&gt; Antenna_Seg3                            Length of third antenna segment</span>
<span class="co">#&gt; Antenna_Seg4                           Length of fourth antenna segment</span>
<span class="co">#&gt; Antenna_Seg5       Length of fifth antenna segment (only Pentatomoidea)</span>
<span class="co">#&gt; Front.Tibia_length                   Length of the tibia of the foreleg</span>
<span class="co">#&gt; Mid.Tibia_length                     Length of the tibia of the mid leg</span>
<span class="co">#&gt; Hind.Tibia_length                   Length of the tibia of the hind leg</span>
<span class="co">#&gt; Front.Femur_length                   Length of the femur of the foreleg</span>
<span class="co">#&gt; Hind.Femur_length                   Length of the femur of the hind leg</span>
<span class="co">#&gt; Front.Femur_width                     Width of the femur of the foreleg</span>
<span class="co">#&gt; Hind.Femur_width                     Width of the femur of the hind leg</span>
<span class="co">#&gt; Rostrum_length             Length of the rostrum including all segments</span>
<span class="co">#&gt; Rostrum_width                                Widest part of the rostrum</span>
<span class="co">#&gt; Wing_length                                Longest part of the forewing</span>
<span class="co">#&gt; Wing_width                                  Widest part of the forewing</span>
<span class="co">#&gt;                    expectedUnit</span>
<span class="co">#&gt; Body_length                  mm</span>
<span class="co">#&gt; Body_width                   mm</span>
<span class="co">#&gt; Body_height                  mm</span>
<span class="co">#&gt; Thorax_length                mm</span>
<span class="co">#&gt; Thorax_width                 mm</span>
<span class="co">#&gt; Head_width                   mm</span>
<span class="co">#&gt; Eye_width                    mm</span>
<span class="co">#&gt; Antenna_Seg1                 mm</span>
<span class="co">#&gt; Antenna_Seg2                 mm</span>
<span class="co">#&gt; Antenna_Seg3                 mm</span>
<span class="co">#&gt; Antenna_Seg4                 mm</span>
<span class="co">#&gt; Antenna_Seg5                 mm</span>
<span class="co">#&gt; Front.Tibia_length           mm</span>
<span class="co">#&gt; Mid.Tibia_length             mm</span>
<span class="co">#&gt; Hind.Tibia_length            mm</span>
<span class="co">#&gt; Front.Femur_length           mm</span>
<span class="co">#&gt; Hind.Femur_length            mm</span>
<span class="co">#&gt; Front.Femur_width            mm</span>
<span class="co">#&gt; Hind.Femur_width             mm</span>
<span class="co">#&gt; Rostrum_length               mm</span>
<span class="co">#&gt; Rostrum_width                mm</span>
<span class="co">#&gt; Wing_length                  mm</span>
<span class="co">#&gt; Wing_width                   mm</span></code></pre></div>
</div>
</div>
<div id="standardize-taxa" class="section level1">
<h1 class="hasAnchor">
<a href="#standardize-taxa" class="anchor"></a>3. Standardize taxa</h1>
<p>For taxon name standardisation, the function <code><a href="../reference/standardize_taxa.html">standardize_taxa()</a></code> makes use of fuzzy matching algorithms provided by the package <a href="https://CRAN.R-project.org/package=taxize">‘taxize’ by Scott Chamberlain</a> to match the entries of column <code>verbatimScientificName</code> against the GBIF Backbone Taxonomy. The result is written into a new column <code>scientificName</code>. Additional columns comprise the order (for ambiguous names), the reported taxon rank, as well as a globally unique taxon ID which references the taxon to GBIF Backbone Taxonomy in a universal URI format.</p>
<p>If further layers of taxonomic information are desired as an output, the function takes the parameter <code>return</code>, which by default contains <code><a href="https://rdrr.io/r/base/c.html">c("taxonID", "scientificName", "order", "taxonRank")</a></code>. Other specifications can be added here.</p>
<p>Note that for this to work, <code>verbatimScientificName</code> must contain a full account of the species name or higher taxon, no abbreviations (spaces or underscores are handled alright). Note also, that taxon name mapping requires an internet connection and might take some time, depending on the length of your species list.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset1Std</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/standardize_taxa.html">standardize_taxa</a></span><span class="op">(</span><span class="va">dataset1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataset1Std</span><span class="op">)</span>
<span class="co">#&gt;          scientificName verbatimScientificName verbatimTraitName</span>
<span class="co">#&gt; 1 Abax parallelepipedus  Abax_parallelepipedus       body_length</span>
<span class="co">#&gt; 2 Abax parallelepipedus  Abax_parallelepipedus    antenna_length</span>
<span class="co">#&gt; 3 Abax parallelepipedus  Abax_parallelepipedus     eyewidth_corr</span>
<span class="co">#&gt; 4 Abax parallelepipedus  Abax_parallelepipedus  metafemur_length</span>
<span class="co">#&gt; 5  Acupalpus meridianus   Acupalpus_meridianus    antenna_length</span>
<span class="co">#&gt; 6  Acupalpus meridianus   Acupalpus_meridianus  metafemur_length</span>
<span class="co">#&gt;   verbatimTraitValue verbatimTraitUnit                             taxonID</span>
<span class="co">#&gt; 1          15.846561                mm http://www.gbif.org/species/5754772</span>
<span class="co">#&gt; 2           8.518519                mm http://www.gbif.org/species/5754772</span>
<span class="co">#&gt; 3           0.481250                mm http://www.gbif.org/species/5754772</span>
<span class="co">#&gt; 4           5.608466                mm http://www.gbif.org/species/5754772</span>
<span class="co">#&gt; 5           0.700000                mm http://www.gbif.org/species/1037633</span>
<span class="co">#&gt; 6           0.750000                mm http://www.gbif.org/species/1037633</span>
<span class="co">#&gt;   measurementID warnings taxonRank  kingdom     phylum   class      order</span>
<span class="co">#&gt; 1             1            species Animalia Arthropoda Insecta Coleoptera</span>
<span class="co">#&gt; 2           121            species Animalia Arthropoda Insecta Coleoptera</span>
<span class="co">#&gt; 3           361            species Animalia Arthropoda Insecta Coleoptera</span>
<span class="co">#&gt; 4           241            species Animalia Arthropoda Insecta Coleoptera</span>
<span class="co">#&gt; 5           122            species Animalia Arthropoda Insecta Coleoptera</span>
<span class="co">#&gt; 6           242            species Animalia Arthropoda Insecta Coleoptera</span>
<span class="co">#&gt;      family measurementDeterminedBy measurementRemarks</span>
<span class="co">#&gt; 1 Carabidae                   klink               &lt;NA&gt;</span>
<span class="co">#&gt; 2 Carabidae                   klink               &lt;NA&gt;</span>
<span class="co">#&gt; 3 Carabidae                   klink               &lt;NA&gt;</span>
<span class="co">#&gt; 4 Carabidae                   klink               &lt;NA&gt;</span>
<span class="co">#&gt; 5 Carabidae                WOODCOCK               &lt;NA&gt;</span>
<span class="co">#&gt; 6 Carabidae                WOODCOCK               &lt;NA&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This trait-dataset contains 4 traits for 120 taxa ( 480 measurements in total).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  carabids : Carabid traits by Fons van der Plas .</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     When using these data, you must acknowledge the following usage policies: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Cite this trait dataset as: </span>
<span class="co">#&gt; van der Plas F, van Klink R, Manning P, Olff H, Fischer M (2017).</span>
<span class="co">#&gt; "Sensitivity of functional diversity metrics to sampling intensity."</span>
<span class="co">#&gt; _Methods in Ecology and Evolution_. doi: 10.1111/2041-210x.12728 (URL:</span>
<span class="co">#&gt; https://doi.org/10.1111/2041-210x.12728).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Published under: http://creativecommons.org/publicdomain/zero/1.0/ </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     This dataset conforms to: [1] "Ecological Trait-data Standard (ETS) v0.10"</span></code></pre></div>
<!--
## georeference standardization for Biodiversity Exploratories

The traitdata standard has been developed within the Biodiversity Exploratories project (DFG ) which is a long-term assessment of plant and animal communities in three regions across Germany starting in 2008. Trait data extracted from one of the 300 project plots can be georeferenced using the function `standardize.exploratories()`. 

To access the high-resolution location data, credentials to BEXIS will be requested. If credentials are incorrect or missing, only low-resolution geolocation can be extracted. 


```r
# dataset by Jule Mangels et al. 

moths <- read.service(21247, dec = ",") 
 
dataset5 <- as.traitdata(moths, taxa = "species", traits = c(body_mass =
     "weight", wing_length = "wing_length", wing_width = "wing_width", wing_area =
     "wing_area", wing_loading = "wing_loading"),
   keep = c(locationID = "plot"))
 
dataset5Std <- standardize.exploratories(dataset1)

head(dataset5Std)
```
-->
<div id="single-stroke-standardization" class="section level2">
<h2 class="hasAnchor">
<a href="#single-stroke-standardization" class="anchor"></a>Single-stroke standardization</h2>
<p>The functions <code><a href="../reference/standardize_traits.html">standardize_traits()</a></code> and <code><a href="../reference/standardize_taxa.html">standardize_taxa()</a></code> are applied sequentially but not necessarily in that order. The output of the first step can be piped into the second step.</p>
<p>To make things even simpler, the functions for format conversion and standardization come with a wrapper function <code><a href="../reference/standardize.html">standardize()</a></code>. Therefore it is possible to run the functions in a single-handed way, if all necessary parameters for the intermediate steps are provided. A single call will do, taking all the optional parameters described above.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataset1Std</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/standardize.html">standardize</a></span><span class="op">(</span><span class="va">carabids</span>,
            thesaurus <span class="op">=</span> <span class="va">thesaurus1</span>,
            taxa <span class="op">=</span> <span class="st">"name_correct"</span>,
            units <span class="op">=</span> <span class="st">"mm"</span>,
            keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>measurementDeterminedBy <span class="op">=</span> <span class="st">"source_measurement"</span><span class="op">)</span>
            <span class="op">)</span></code></pre></div>
<p>As an alternative input pathway, all parameters to <code><a href="../reference/standardize.html">standardize()</a></code> can be specified as attributes of the input object and will be found natively by the function. This allows for the specification of recipes for data integration for projects pulling data from multiple sources.</p>
</div>
</div>
<div id="working-with-trait-datasets" class="section level1">
<h1 class="hasAnchor">
<a href="#working-with-trait-datasets" class="anchor"></a>4. Working with trait-datasets</h1>
<div id="combine-multiple-traitdata-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#combine-multiple-traitdata-tables" class="anchor"></a>combine multiple traitdata tables</h2>
<p>After standardizing trait and taxon concepts into unified definitions and converting trait values into harmonized units, it is straightforward to combine multiple trait-dataset into one using <code><a href="https://rdrr.io/r/base/cbind.html">rbind()</a></code>. This can be applied before or after the standardisation process, depending on the use case. Use cases of merging data are:</p>
<ul>
<li>you collected data from different sources and want to harmonize taxon and trait names: bring data in long-table format and merge into one data object, then harmonize taxa and units following a uniform standard</li>
<li>No unified trait list or taxon reference exists for the heterogeneous data assembled of different sources (e.g. because spanning many different taxa): Apply standardization to different reference systems before merging the datasets.</li>
</ul>
<p>The function call will append the data tables while merging the common columns and maintaining columns that are not present in all datasets (this might produce lots of NA). The column <code>datasetID</code> will be added to keep track of the origin of the data. By default this column will contain the object names of the original datasets, but it can be replaced by more meaningful IDs using the parameter <code>datasetID</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">dataset1Std</span>, <span class="va">dataset2Std</span>, 
                datasetID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"vanderplas15"</span>, <span class="st">"gossner15"</span><span class="op">)</span>
              <span class="op">)</span></code></pre></div>
<p>Note that the package provides a method for the base function <code><a href="https://rdrr.io/r/base/cbind.html">rbind()</a></code> that handles this merge. Documentation can be accessed via <code><a href="../reference/rbind.traitdata.html">?rbind.traitdata</a></code>.</p>
</div>
<div id="maintaining-metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#maintaining-metadata" class="anchor"></a>maintaining metadata</h2>
<p>The function will handle metadata information on the dataset level as described in the section ‘Metadata’ of the Traitdata Standard (e.g. <code>author</code> or <code>bibliographicCitation</code>) and add a column <code>datasetID</code> as well as <code>datasetName</code> and <code>author</code> if those are provided in the parameter <code>metadata</code> of the <code><a href="../reference/as.traitdata.html">as.traitdata()</a></code> function call which creates the data. The function <code><a href="../reference/as.metadata.html">as.metadata()</a></code> provides a standard structure for this case.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">metadata1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.metadata.html">as.metadata</a></span><span class="op">(</span>
      datasetName <span class="op">=</span> <span class="st">"Carabid traits"</span>,
      datasetID <span class="op">=</span> <span class="st">"carabids"</span>,
      bibliographicCitation <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/utils/bibentry.html">bibentry</a></span><span class="op">(</span>
        bibtype <span class="op">=</span> <span class="st">"Article"</span>,
        title <span class="op">=</span> <span class="st">"Sensitivity of functional diversity metrics to sampling intensity"</span>,
        journal <span class="op">=</span> <span class="st">"Methods in Ecology and Evolution"</span>,
        author <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/person.html">as.person</a></span><span class="op">(</span><span class="st">"Fons van der Plas, Roel van Klink, Pete Manning, Han Olff, Markus Fischer"</span><span class="op">)</span>
        <span class="op">)</span>,
        year <span class="op">=</span> <span class="fl">2017</span>,
        doi <span class="op">=</span> <span class="st">"10.1111/2041-210x.12728"</span>
      <span class="op">)</span>,
      author <span class="op">=</span> <span class="st">"Fons van der Plas"</span>,
      license <span class="op">=</span> <span class="st">"http://creativecommons.org/publicdomain/zero/1.0/"</span>
       <span class="op">)</span>

<span class="va">dataset1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.traitdata.html">as.traitdata</a></span><span class="op">(</span><span class="va">carabids</span>,
  taxa <span class="op">=</span> <span class="st">"name_correct"</span>,
  thesaurus <span class="op">=</span> <span class="va">thesaurus1</span>,
  units <span class="op">=</span> <span class="st">"mm"</span>,
  keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>datasetID <span class="op">=</span> <span class="st">"source_measurement"</span>, measurementRemark <span class="op">=</span> <span class="st">"note"</span><span class="op">)</span>,
  metadata <span class="op">=</span> <span class="va">metadata1</span>
<span class="op">)</span>
<span class="co">#&gt; Input is taken to be a species -- trait matrix. If this is not the case, please provide parameters!</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dataset1</span><span class="op">)</span>
<span class="co">#&gt;   verbatimScientificName verbatimTraitName verbatimTraitValue verbatimTraitUnit</span>
<span class="co">#&gt; 1  Abax_parallelepipedus    antenna_length           8.518519                mm</span>
<span class="co">#&gt; 2   Acupalpus_meridianus    antenna_length           0.700000                mm</span>
<span class="co">#&gt; 3         Agonum_ericeti    antenna_length           3.743386                mm</span>
<span class="co">#&gt; 4     Agonum_fuliginosum    antenna_length           3.500000                mm</span>
<span class="co">#&gt; 5         Agonum_gracile    antenna_length           3.220000                mm</span>
<span class="co">#&gt; 6      Agonum_marginatum    antenna_length           5.030000                mm</span>
<span class="co">#&gt;   measurementID datasetID  measurementRemark</span>
<span class="co">#&gt; 1             1     klink               &lt;NA&gt;</span>
<span class="co">#&gt; 2             2  WOODCOCK               &lt;NA&gt;</span>
<span class="co">#&gt; 3             3     klink               &lt;NA&gt;</span>
<span class="co">#&gt; 4             4    ribera               &lt;NA&gt;</span>
<span class="co">#&gt; 5             5    ribera deduced_from_genus</span>
<span class="co">#&gt; 6             6    ribera               &lt;NA&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This trait-dataset contains 4 traits for 120 taxa ( 480 measurements in total).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  carabids : Carabid traits by Fons van der Plas .</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     When using these data, you must acknowledge the following usage policies: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Cite this trait dataset as: </span>
<span class="co">#&gt; van der Plas F, van Klink R, Manning P, Olff H, Fischer M (2017).</span>
<span class="co">#&gt; "Sensitivity of functional diversity metrics to sampling intensity."</span>
<span class="co">#&gt; _Methods in Ecology and Evolution_. doi: 10.1111/2041-210x.12728 (URL:</span>
<span class="co">#&gt; https://doi.org/10.1111/2041-210x.12728).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Published under: http://creativecommons.org/publicdomain/zero/1.0/ </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     This dataset conforms to: [1] "Ecological Trait-data Standard (ETS) v0.10"</span></code></pre></div>
<p>Note the use of the <code><a href="https://rdrr.io/r/utils/bibentry.html">bibentry()</a></code> function to create a formal bibliographic entry. Also note that this also affects the way how the dataset is printed into the R console. This facilitates for data users to acknowledge authorship and ownership of the data, while also providing a machine readable structure that can easily be accessed further down the line.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">metadata2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.metadata.html">as.metadata</a></span><span class="op">(</span>
  datasetName <span class="op">=</span> <span class="st">"Heteroptera morphometry traits"</span>,
  datasetID <span class="op">=</span> <span class="st">"heteroptera"</span>,
  bibliographicCitation <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/utils/bibentry.html">bibentry</a></span><span class="op">(</span>
    bibtype <span class="op">=</span> <span class="st">"Article"</span>,
    title <span class="op">=</span> <span class="st">"Morphometric measures of Heteroptera sampled in grasslands across three regions of Germany"</span>,
    journal <span class="op">=</span> <span class="st">"Ecology"</span>,
    volume <span class="op">=</span> <span class="fl">96</span>,
    issue <span class="op">=</span> <span class="fl">4</span>,
    pages <span class="op">=</span> <span class="fl">1154</span>,
    author <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/person.html">as.person</a></span><span class="op">(</span><span class="st">"Martin M. Gossner , Nadja K. Simons, Leonhard Hoeck, Wolfgang W. Weisser"</span><span class="op">)</span><span class="op">)</span>,
    year <span class="op">=</span> <span class="fl">2015</span>,
    doi <span class="op">=</span> <span class="st">"10.1890/14-2159.1"</span>
  <span class="op">)</span>,
  author <span class="op">=</span> <span class="st">"Martin M. Gossner"</span>,
  license <span class="op">=</span> <span class="st">"http://creativecommons.org/publicdomain/zero/1.0/"</span>
<span class="op">)</span>

<span class="va">dataset2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as.traitdata.html">as.traitdata</a></span><span class="op">(</span><span class="va">heteroptera_raw</span>,
  taxa <span class="op">=</span> <span class="st">"SpeciesID"</span>,
  thesaurus <span class="op">=</span> <span class="va">thesaurus2</span>,
  units <span class="op">=</span> <span class="st">"mm"</span>,
  keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>sex <span class="op">=</span> <span class="st">"Sex"</span>, references <span class="op">=</span> <span class="st">"Source"</span>, lifestage <span class="op">=</span> <span class="st">"Wing_development"</span><span class="op">)</span>,
  metadata <span class="op">=</span>  <span class="va">metadata2</span>
<span class="op">)</span>
<span class="co">#&gt; Input is taken to be an occurrence table/an observation -- trait matrix </span>
<span class="co">#&gt; (i.e. with individual specimens per row and multiple trait measurements in columns). </span>
<span class="co">#&gt; If this is not the case, please provide parameters!</span>
<span class="va">database</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">dataset1</span>, <span class="va">dataset2</span>, 
                datasetID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"vanderplas17"</span>, <span class="st">"gossner15"</span><span class="op">)</span>, 
                metadata_as_columns <span class="op">=</span> <span class="cn">TRUE</span>
                <span class="op">)</span> 

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">database</span><span class="op">)</span>
<span class="co">#&gt;   verbatimScientificName verbatimTraitName verbatimTraitValue verbatimTraitUnit</span>
<span class="co">#&gt; 1  Abax_parallelepipedus    antenna_length           8.518519                mm</span>
<span class="co">#&gt; 2   Acupalpus_meridianus    antenna_length           0.700000                mm</span>
<span class="co">#&gt; 3         Agonum_ericeti    antenna_length           3.743386                mm</span>
<span class="co">#&gt; 4     Agonum_fuliginosum    antenna_length           3.500000                mm</span>
<span class="co">#&gt; 5         Agonum_gracile    antenna_length           3.220000                mm</span>
<span class="co">#&gt; 6      Agonum_marginatum    antenna_length           5.030000                mm</span>
<span class="co">#&gt;   measurementID occurrenceID references  sex datasetID    datasetName</span>
<span class="co">#&gt; 1             1         &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;  carabids Carabid traits</span>
<span class="co">#&gt; 2             2         &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;  carabids Carabid traits</span>
<span class="co">#&gt; 3             3         &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;  carabids Carabid traits</span>
<span class="co">#&gt; 4             4         &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;  carabids Carabid traits</span>
<span class="co">#&gt; 5             5         &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;  carabids Carabid traits</span>
<span class="co">#&gt; 6             6         &lt;NA&gt;       &lt;NA&gt; &lt;NA&gt;  carabids Carabid traits</span>
<span class="co">#&gt;              author                                           license</span>
<span class="co">#&gt; 1 Fons van der Plas http://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="co">#&gt; 2 Fons van der Plas http://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="co">#&gt; 3 Fons van der Plas http://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="co">#&gt; 4 Fons van der Plas http://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="co">#&gt; 5 Fons van der Plas http://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="co">#&gt; 6 Fons van der Plas http://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="co">#&gt;    measurementRemark lifestage</span>
<span class="co">#&gt; 1               &lt;NA&gt;      &lt;NA&gt;</span>
<span class="co">#&gt; 2               &lt;NA&gt;      &lt;NA&gt;</span>
<span class="co">#&gt; 3               &lt;NA&gt;      &lt;NA&gt;</span>
<span class="co">#&gt; 4               &lt;NA&gt;      &lt;NA&gt;</span>
<span class="co">#&gt; 5 deduced_from_genus      &lt;NA&gt;</span>
<span class="co">#&gt; 6               &lt;NA&gt;      &lt;NA&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; This trait-dataset contains 27 traits for 299 taxa ( 9386 measurements in total).</span>
<span class="co">#&gt; $carabids</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  carabids : Carabid traits by Fons van der Plas .</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     When using these data, you must acknowledge the following usage policies: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Cite this trait dataset as: </span>
<span class="co">#&gt; van der Plas F, van Klink R, Manning P, Olff H, Fischer M (2017).</span>
<span class="co">#&gt; "Sensitivity of functional diversity metrics to sampling intensity."</span>
<span class="co">#&gt; _Methods in Ecology and Evolution_. doi: 10.1111/2041-210x.12728 (URL:</span>
<span class="co">#&gt; https://doi.org/10.1111/2041-210x.12728).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Published under: http://creativecommons.org/publicdomain/zero/1.0/ </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     This dataset conforms to: [1] "Ecological Trait-data Standard (ETS) v0.10"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $heteroptera</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  heteroptera : Heteroptera morphometry traits by Martin M. Gossner .</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     When using these data, you must acknowledge the following usage policies: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Cite this trait dataset as: </span>
<span class="co">#&gt; Gossner MM, Simons NK, Hoeck L, Weisser WW (2015). "Morphometric</span>
<span class="co">#&gt; measures of Heteroptera sampled in grasslands across three regions of</span>
<span class="co">#&gt; Germany." _Ecology_, *96*, 1154. doi: 10.1890/14-2159.1 (URL:</span>
<span class="co">#&gt; https://doi.org/10.1890/14-2159.1).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Published under: http://creativecommons.org/publicdomain/zero/1.0/ </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     This dataset conforms to: [1] "Ecological Trait-data Standard (ETS) v0.10"</span></code></pre></div>
<p>The detailed metadata information of both datasets (e.g. license and bibliographic citation) will be stored in the attributes of the dataset and displayed when calling it in R console. You can access the metadata via the <code><a href="https://rdrr.io/r/base/attributes.html">attributes()</a></code> function. E.g.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">dataset1</span><span class="op">)</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">bibliographicCitation</span>
<span class="co">#&gt; van der Plas F, van Klink R, Manning P, Olff H, Fischer M (2017).</span>
<span class="co">#&gt; "Sensitivity of functional diversity metrics to sampling intensity."</span>
<span class="co">#&gt; _Methods in Ecology and Evolution_. doi: 10.1111/2041-210x.12728 (URL:</span>
<span class="co">#&gt; https://doi.org/10.1111/2041-210x.12728).</span></code></pre></div>
</div>
<div id="writing-data-recipes" class="section level2">
<h2 class="hasAnchor">
<a href="#writing-data-recipes" class="anchor"></a>writing data recipes</h2>
<p>For projects compiling data from multiple sources, it is recommended best practice to refer to original raw data, potentially even by pulling them from their original repository, and make any changes and standardisation procedures script based in R. If many field-based changes are necessary, you can refer to <a href="https://nicercode.github.io/blog/2013-07-09-modifying-data-with-lookup-tables/">lookup tables</a> to keep the script slim.</p>
<p><code>traitdataform</code> allows you to script all parameters required for the standardization call into the attributes of the R object. A script for a single data source can then look like this</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">carabids</span> <span class="op">&lt;-</span> <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html">url</a></span><span class="op">(</span><span class="st">"https://datadryad.org/stash/downloads/file_stream/24267"</span>, 
                                encoding <span class="op">=</span> <span class="st">"UTF-8"</span><span class="op">)</span>
                              <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">carabids</span>, <span class="st">'metadata'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">traitdataform</span><span class="fu">::</span><span class="fu"><a href="../reference/as.metadata.html">as.metadata</a></span><span class="op">(</span>
      datasetName <span class="op">=</span> <span class="st">"Carabid traits"</span>,
      datasetID <span class="op">=</span> <span class="st">"carabids"</span>,
      bibliographicCitation <span class="op">=</span>  <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/bibentry.html">bibentry</a></span><span class="op">(</span>
        bibtype <span class="op">=</span> <span class="st">"Article"</span>,
        title <span class="op">=</span> <span class="st">"Sensitivity of functional diversity metrics to sampling intensity"</span>,
        journal <span class="op">=</span> <span class="st">"Methods in Ecology and Evolution"</span>,
        author <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/person.html">as.person</a></span><span class="op">(</span><span class="st">"Fons van der Plas, Roel van Klink, Pete Manning, Han Olff, Markus Fischer"</span><span class="op">)</span>
        <span class="op">)</span>,
        year <span class="op">=</span> <span class="fl">2017</span>,
        doi <span class="op">=</span> <span class="st">"10.1111/2041-210x.12728"</span>
      <span class="op">)</span>,
      author <span class="op">=</span> <span class="st">"Fons van der Plas"</span>,
      license <span class="op">=</span> <span class="st">"http://creativecommons.org/publicdomain/zero/1.0/"</span>
       <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">carabids</span>, <span class="st">'thesaurus'</span><span class="op">)</span> <span class="op">&lt;-</span>  <span class="fu">traitdataform</span><span class="fu">:::</span><span class="fu"><a href="../reference/as.thesaurus.html">as.thesaurus</a></span><span class="op">(</span>
          body_length <span class="op">=</span> <span class="fu">traitdataform</span><span class="fu">:::</span><span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"body_length"</span>,
                              expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                              identifier <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Body_length"</span><span class="op">)</span>,
          antenna_length <span class="op">=</span> <span class="fu">traitdataform</span><span class="fu">:::</span><span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"antenna_length"</span>,
                              expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                              identifier <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Antenna_length"</span><span class="op">)</span>,
          metafemur_length <span class="op">=</span> <span class="fu">traitdataform</span><span class="fu">:::</span><span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"femur_length"</span>,
                              expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                              identifier <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Femur_length"</span><span class="op">)</span>,
          eyewidth_corr <span class="op">=</span> <span class="fu">traitdataform</span><span class="fu">:::</span><span class="fu"><a href="../reference/as.trait.html">as.trait</a></span><span class="op">(</span><span class="st">"eye_diameter"</span>,
                              expectedUnit <span class="op">=</span> <span class="st">"mm"</span>, valueType <span class="op">=</span> <span class="st">"numeric"</span>,
                              identifier <span class="op">=</span> <span class="st">"http://t-sita.cesab.org/BETSI_vizInfo.jsp?trait=Eye_diameter"</span><span class="op">)</span>
        <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">carabids</span>, <span class="st">'taxa'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"name_correct"</span>
<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">carabids</span>, <span class="st">'units'</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"mm"</span>
<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">carabids</span>, <span class="st">'keep'</span><span class="op">)</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>measurementDeterminedBy <span class="op">=</span> <span class="st">"source_measurement"</span>, measurementRemarks <span class="op">=</span> <span class="st">"note"</span><span class="op">)</span></code></pre></div>
<p>When thus specified, the data can be re-formatted simply by calling <code><a href="../reference/standardize.html">standardize(carabids)</a></code>.</p>
<!--
## add data layers

When storing data, it might be advised to externalise repetitive entries in a separate datasheet and link to it via datasetID. In R, you can use the function `merge()` to map metadata information from a second data table into the core data table based on the datasetID. 


```r
#example for adding metadata as a table
```


## compile aggregate values

The function `cast.traitdata()` rearranges the long-table format into the more intuitive wide-table or matrix format. This can be used to preview complex datasets or to perform calculations on multivariate values. 


```r
head(dataset3)

dataset3wide <- cast.traitdata(dataset3)

head(dataset3wide)
```
-->
</div>
</div>
<div id="writing-data" class="section level1">
<h1 class="hasAnchor">
<a href="#writing-data" class="anchor"></a>5. Writing data</h1>
<p>The final step in converting trait data into a standardised format before uploading the file to a public file hosting service is saving them in a file format that is internationalized, portable and long-term accessible. Internationalization refers to the file encoding (‘UTF-8’ should be used, ‘ASCII’ is possible for data with no special characters) as well as the use of decimal delimiters (highly recommended to use ‘.’) and internationally accepted formatting standards for values such as dates (the international norm for date entries is ISO 8601, i.e. “YYYY-MM-DD”). Portability means that the file can be opened on all operating systems (specifically important, the ‘end of line’ character) and does not rely on proprietary software (like MS Excel or database tools). Long-term accessibility is warranted by choosing a text-based file format (txt, csv or tsv) and by packaging the primary data with all necessary metadata.</p>
<p>The base R function <code><a href="https://rdrr.io/r/utils/write.table.html">write.table()</a></code> gives full control over these parameters and should be used to export trait-data.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">dataset1Std</span>, file <span class="op">=</span> <span class="st">"carabids_std.csv"</span>, 
            sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span>, quote <span class="op">=</span> <span class="cn">TRUE</span>, eol <span class="op">=</span> <span class="st">"\r"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Along with these primary data, you should make any ancillary data table available along with the data, e.g. the metadata in a human readable form, as well as the lookup table of traits and taxa:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html">capture.output</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">dataset1Std</span><span class="op">)</span><span class="op">$</span><span class="va">metadata</span>, file <span class="op">=</span> <span class="st">"metadata.txt"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">dataset1Std</span><span class="op">)</span><span class="op">$</span><span class="va">traits</span>, file <span class="op">=</span> <span class="st">"traits.csv"</span>, 
            sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span>, quote <span class="op">=</span> <span class="cn">TRUE</span>, eol <span class="op">=</span> <span class="st">"\r"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">dataset1Std</span><span class="op">)</span><span class="op">$</span><span class="va">taxonomy</span>, file <span class="op">=</span> <span class="st">"taxa.csv"</span>, 
            sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span>, quote <span class="op">=</span> <span class="cn">TRUE</span>, eol <span class="op">=</span> <span class="st">"\r"</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>When publishing the trait data on file servers like Figshare or Zenodo, those files should be uploaded in a single file repository (e.g. in a zip file). R does the archiving for you using <code><a href="https://rdrr.io/r/utils/zip.html">zip()</a></code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/zip.html">zip</a></span><span class="op">(</span><span class="st">"carabids_std.zip"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"carabids_std.csv"</span>, <span class="st">"metadata.txt"</span>, <span class="st">"traits.csv"</span>, <span class="st">"taxa.csv"</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<p>More advise for publishing trait data in a standardised way can be found in our <a href="https://ecologicaltraitdata.github.io/ETS/bestpractice.html">‘Best practice examples for primary data publication’</a> <span class="citation">(Schneider et al., 2018)</span>.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-cornelissen03">
<p>Cornelissen, J. H. C., Lavorel, S., Garnier, E., Diaz, S., Buchmann, N., Gurvich, D. E., … Van Der Heijden, M. G. A. (2003). A handbook of protocols for standardised and easy measurement of plant functional traits worldwide. <em>Australian Journal of Botany</em>, <em>51</em>(4), 335–380.</p>
</div>
<div id="ref-garnier17">
<p>Garnier, E., Stahl, U., Laporte, M.-A., Kattge, J., Mougenot, I., Kühn, I., … Klotz, S. (2017). Towards a thesaurus of plant characteristics: An ecological contribution. <em>Journal of Ecology</em>, <em>105</em>(2), 298–309. doi:<a href="https://doi.org/10.1111/1365-2745.12698">10.1111/1365-2745.12698</a></p>
</div>
<div id="ref-kattge11a">
<p>Kattge, J., Ogle, K., Bönisch, G., Díaz, S., Lavorel, S., Madin, J., … Wirth, C. (2011). A generic structure for plant trait databases. <em>Methods in Ecology and Evolution</em>, <em>2</em>(2), 202–213. doi:<a href="https://doi.org/10.1111/j.2041-210X.2010.00067.x">10.1111/j.2041-210X.2010.00067.x</a></p>
</div>
<div id="ref-moretti17">
<p>Moretti, M., Dias, A. T., Bello, F., Altermatt, F., Chown, S. L., Azcárate, F. M., … others. (2017). Handbook of protocols for standardized measurement of terrestrial invertebrate functional traits. <em>Functional Ecology</em>, <em>31</em>(3), 558–567. doi:<a href="https://doi.org/10.1111/1365-2435.12776">10.1111/1365-2435.12776</a></p>
</div>
<div id="ref-parr16">
<p>Parr, C. S., Schulz, K. S., Hammock, J., Wilson, N., Leary, P., Rice, J., … J, R. (2016). TraitBank: Practical semantics for organism attribute data. <em>Semantic Web</em>, <em>7</em>(6), 577–588. doi:<a href="https://doi.org/10.3233/SW-150190">10.3233/SW-150190</a></p>
</div>
<div id="ref-pebesma16">
<p>Pebesma, E., Mailund, T., &amp; Hiebert, J. (2016). Measurement Units in R. <em>The R Journal</em>, <em>8</em>(2), 486–494. doi:<a href="https://doi.org/10.32614/RJ-2016-061">10.32614/RJ-2016-061</a></p>
</div>
<div id="ref-perez-harguindeguy13">
<p>Perez-Harguindeguy, N., Diaz, S., Garnier, E., Lavorel, S., Poorter, H., Jaureguiberry, P., … Gurvich, D. E. (2013). New handbook for standardised measurement of plant functional traits worldwide. <em>Australian Journal of Botany</em>, <em>61</em>(3), 167–234.</p>
</div>
<div id="ref-schneider18">
<p>Schneider, F. D., Jochum, M., Provost, G. L., Ostrowski, A., Penone, C., Fichtmüller, D., … Simons, N. K. (2018). Towards an Ecological Trait-data Standard. <em>bioRxiv</em>, 328302. doi:<a href="https://doi.org/10.1101/328302">10.1101/328302</a></p>
</div>
<div id="ref-wickham14">
<p>Wickham, H. (2014). Tidy data. <em>Journal of Statistical Software</em>, <em>59</em>(10), 1–23. doi:<a href="https://doi.org/10.18637/jss.v059.i10">10.18637/jss.v059.i10</a></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Florian D. Schneider.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
